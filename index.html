<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title></title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
html, body { height: 100%; margin: 0; }
body {
  display: grid; place-items: center;
 /* Hintergrundbild von Pexels ‚Äì Foto von Markus Spiske */
  background: url('https://images.pexels.com/photos/1089438/pexels-photo-1089438.jpeg') no-repeat center center;
  background-size: cover;
  color: white;
  font-family: Arial, Sans-Pixel; text-align: center;
}
#gameContainer {
  width: 90%; max-width: 700px; min-height: 520px;
  padding: 20px;  border-radius: 15px;
  box-shadow: 0 0 25px rgba(255,255,255,0.08);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
}
  #tipButton {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: none;
  border: none;
  color: white;
  font-size: 28px;
  cursor: pointer;
  z-index: 1000;
}
#tipButton:hover { color: #4dd0e1; }

.modal {
  display: none;
  position: fixed;
  z-index: 1001;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.7);
}
.modal-content {
  background-color: #111;
  margin: 15% auto;
  padding: 20px;
  border-radius: 12px;
  width: 80%;
  max-width: 400px;
  color: white;
  text-align: left;
}
.close {
  color: white;
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}
.close:hover { color: #4dd0e1; }
 
h1 { font-size: 1.8em; margin-bottom: 20px; color: #4dd0e1; font-family: 'Press Start 2P', cursive; }
#task, #wordDisplay { font-size: 1.4em; margin: 20px 0; min-height: 50px; font-family: 'Press Start 2P', cursive; word-break: keep-all; }
#inputContainer { display: flex; flex-direction: column; align-items: center; }
#playerWord, #answer { width: 80%; max-width: 400px; font-size: 1em; padding: 10px; border-radius: 10px; border: none; margin-bottom: 15px; text-align: center; box-sizingss: border-box; }
button { padding: 12px 25px; font-size: 1em; border: none; border-radius: 10px; background: #2e7d32; color: white; cursor: pointer; transition: all 0.2s; }
button:hover { background: #4caf50; }
#message { margin-top: 20px; font-size: 1em; min-height: 40px; }
#timer { margin-top: 15px; font-size: 1em; font-weight: bold; }
.timer-green { color: #4caf50; }
.timer-yellow { color: #ffc107; }
.timer-red { color: #f44336; }

/* ===================== Tic-Tac-Toe & Chromatic Styles ===================== */
#boardWrapper { display: flex; align-items: center; justify-content: center; width: 100%; }
#board { display: grid; grid-template-columns: repeat(3, 120px); grid-template-rows: repeat(3, 120px); gap: 12px; margin-top:20px; }
.cell { width:120px; height:120px; display:flex; align-items:center; justify-content:center; font-size:48px; cursor:pointer; transition: transform 0.15s, filter 0.15s; color:white; font-weight:bold; border-radius:15px; }
.cell:hover { transform: scale(1.05); filter: brightness(1.15); }
#scoreboard, #level { margin-top:10px; color:white; }

#grid { display: grid; grid-template-columns: repeat(3, 120px); grid-template-rows: repeat(3, 120px); gap: 12px; margin-top:20px; }
.tile { width: 120px; height: 120px; border-radius: 15px; cursor: pointer; transition: transform 0.15s, filter 0.15s; }
.tile:hover { transform: scale(1.05); filter: brightness(1.15); }

@media (max-width:768px){
  h1{font-size:1.4em;} #task, #wordDisplay{font-size:1.2em;} #playerWord, #answer{font-size:0.9em;}
  button{font-size:0.9em; padding:10px 20px;} #board{grid-template-columns:repeat(3,100px);grid-template-rows:repeat(3,100px);} .cell{width:100px;height:100px;font-size:40px;}
}
@media (max-width:600px){#grid{grid-template-columns: repeat(3, 90px); grid-template-rows: repeat(3, 90px);} .tile{width: 90px; height: 90px;}}
</style>
</head>
<body>
<div id="gameContainer">
  <h1></h1>
  <button onclick="startWordChain()">START</button>
</div>
  <!-- Tip Button -->
<button id="tipButton">‚ùóÔ∏è</button>

<!-- Modal f√ºr die Tipps -->
<div id="tipModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <p></p>
  </div>
</div>
  <script>
    // ========================== TIP BUTTON LOGIC ==========================
const tipButton = document.getElementById('tipButton');
const tipModal = document.getElementById('tipModal');
const closeBtn = document.querySelector('.close');

tipButton.onclick = () => {
  let tipText = '';
  if(stage === 'start') tipText = `
    <p> BrainTrials ‚Äì Are you ready?</p>
    <p>You are entering the arena of challenges! Four tricky games await you: Word Chain, Tic-Tac-Toe, Math Challenge, and Chromatic Trial.</p>
    <p>Each level tests your logic, speed, and observation skills. Only those who think cleverly, react quickly, and recognize patterns can reach the end.</p>
    <p>üí° Tip: Sometimes strategy counts more than speed.</p>
  `;

  else if(stage === 'word') tipText = `
      <p>Word Chain Tips:</p>
    <ul>
      <li>Think of the last letter of...</li>
      <li>Find the Answer.</li>
      <li>Longer or smarter‚ùóÔ∏è</li>
    </ul>
  `;

  else if(stage === 'tic') tipText = `
      <p>Tic-Tac-Toe Tips:</p>
    <ul>
      <li>Get three in a row to win.</li>
      <li>Block your opponent.</li>
      <li>The center is powerful.</li>
      <li>It's simple!</li>
    </ul>
  `;

  else if(stage === 'math') tipText = `
      <p>Math Challenge Tips:</p>
    <ul>
      <li>Follow order of operations...</li>
      <li>Solve quickly, time is running!</li>
      <li>Correct answers let you advance,</li>
      <li>Wrong answers send you back.</li>
    </ul>
  `;

  else if(stage === 'chromatic') tipText = `
      <p>Chromatic Trial Tips:</p>
    <ul>
      <li>Make all tiles the same color.</li>
      <li>Focus on one color.</li>
      <li>Act fast, or the grid will reset.</li>
    </ul>
  `;
  tipModal.querySelector('p').innerHTML = tipText;
  tipModal.style.display = 'block';
};

closeBtn.onclick = () => tipModal.style.display = 'none';

window.onclick = (e) => { 
  if(e.target === tipModal) tipModal.style.display = 'none';
};
  
// ========================== VARIABLES ==========================
let stage='start', wordScore=0, ticScore={player:0,ai:0,draw:0};
let currentWord='', usedWords=[], wordList=[];
let board=[], gameOver=false;
let correctAnswer=0, correctMathCount=0;
let timer=10, timerInterval;
let mathTimer=30, mathTimerInterval;

// ========================== WORD CHAIN ==========================
function startWordChain(){
  stage='word';
  const container=document.getElementById('gameContainer');
  container.innerHTML=`
      <h1></h1>
  <div id="wordDisplay">Apple</div>

  <div id="inputContainer">
    <input type="text" id="playerWord" placeholder="Type your word here" autocomplete="off" autocapitalize="none">
    <button onclick="playWord()">OK</button>
  </div>

  <div id="message"></div>

  <!-- üß† Brain Hint -->
  <div id="wordHint" style="
    margin-top:15px;
    font-family:'Press Start 2P', cursive;
    font-size:0.7em;
    color:#ffc107;
    min-height:18px;
    opacity:0;
    transition: opacity 0.5s;
  "></div>
`;
  currentWord='Apple'; usedWords=[currentWord];
  wordList=["Algorithm","Entropy","Hypothesis","Paradox","Labyrinth",
  "Quantum","Syntax","Recursion","Neural","Topology",
  "Cognition","Spectrum","Vector","Matrix","Anomaly",
  "Threshold","Resonance","Asymmetry","Continuum","Parable"];
}
  
function playWord(){
  const input=document.getElementById('playerWord');
  let word=input.value.trim(); word=word.charAt(0).toUpperCase()+word.slice(1);
  const message=document.getElementById('message');
  if(!word) return;
  // Mindestl√§nge
if(word.length < 6){
  message.textContent = "‚ùå Wrong!";
  return;
}


  // Kein gleicher Endbuchstabe wie davor
const lastTwo = currentWord.slice(-2).toLowerCase();
if(word.slice(-1).toLowerCase() === lastTwo[0]){
  message.textContent = "‚ùå Weak ending!";
  return;
  
}
  const lastChar=currentWord.slice(-1).toLowerCase();
  const reversed=currentWord.split("").reverse().join("").toLowerCase();
  if(word[0].toLowerCase()!==lastChar){message.textContent="‚ùå Wrong!";return;}
  if(word.toLowerCase()===currentWord.toLowerCase()){message.textContent="‚ùå Repeat!";return;}
  if(word.toLowerCase()===reversed){message.textContent="‚ùå Reversed!";return;}
  if(usedWords.map(w=>w.toLowerCase()).includes(word.toLowerCase())){message.textContent="‚ùå Already used!";return;}
  usedWords.push(word); currentWord=word;
  document.getElementById('wordDisplay').textContent=``;
  input.value=''; message.textContent='';
  setTimeout(aiTurn,500);
}
function aiTurn(){
  const lastChar = currentWord.slice(-1).toLowerCase();
  let possible = wordList.filter(
    w => w[0].toLowerCase() === lastChar && !usedWords.includes(w)
  );// Wenn keine passenden W√∂rter ‚Üí Brain Hint
if(possible.length === 0){
  setTimeout(showWordChainHint, 5000);
  return;
}
  if(possible.length === 0){
    const remaining = wordList.filter(w => !usedWords.includes(w));
    if(remaining.length > 0){
      const r = remaining[Math.floor(Math.random() * remaining.length)];
      usedWords.push(r);
      currentWord = r;
      document.getElementById('wordDisplay').textContent = currentWord;
    }
    return;
  }

  let best = possible[0];
  let max = -1;

  for(let w of possible){
    const next = w.slice(-1).toLowerCase();
    const opts = wordList.filter(
      p => p[0].toLowerCase() === next && !usedWords.includes(p)
    );
    if(opts.length > max){
      max = opts.length;
      best = w;
    }
  } // ‚úÖ DIESE KLAMMER HAT GEFEHLT

  usedWords.push(best);
  currentWord = best;
  document.getElementById('wordDisplay').textContent = currentWord;

  wordScore++;

  if(wordScore >= 6){
    const msg = document.getElementById('message');
    msg.textContent = '';
    setTimeout(startTicTacToe, 500);
  }
}

function showWordChainHint() {
  const hint = document.getElementById('wordHint');
  if (!hint) return; // Falls das Element noch nicht geladen ist
  hint.textContent = "Only the right words will take you further";
  hint.style.opacity = "1";

  setTimeout(() => {
    hint.style.opacity = "0";
  }, 3000);
}
// ========================== TIC TAC TOE ==========================
function startTicTacToe(){
  stage='tic';
  const container=document.getElementById('gameContainer');
  container.innerHTML=`
    <h1></h1>
    <div id="boardWrapper"><div id="board"></div></div>
    <div id="timer">10</div>
    <div id="message"></div>
    <div id="scoreboard">Player: 0 | AI: 0 | Draws: 0</div>
    <div id="level">
      Level: 
      <select id="levelSelect">
        <option value="easy">Easy</option>
        <option value="medium" selected>Medium</option>
        <option value="hard">Hard</option>
      </select>
    </div>
  `;
  board=['','','','','','','','','']; ticScore={player:0,ai:0,draw:0}; gameOver=false; renderBoard(); startTimer();
}

function renderBoard(){
  const b=document.getElementById('board');
  b.innerHTML='';
  board.forEach((c,i)=>{
    const d=document.createElement('div');
    d.className='cell';
    d.textContent=c;
    if(c==='') d.style.backgroundColor=randomColor();
    d.onclick=()=>playerMove(i);
    b.appendChild(d);
  });
}
function randomColor(){const c=["#ba68c8",
"#64b5f6",
"#81c784",
"#ffb74d",
"#e57373",
"#ffffff",
"#4dd0e1"]; return c[Math.floor(Math.random()*c.length)];}
function startTimer(){clearInterval(timerInterval); timer=10; updateTimerUI(); timerInterval=setInterval(()=>{timer--; updateTimerUI(); if(timer===0){clearInterval(timerInterval); aiMove();}},1000);}
function updateTimerUI(){const d=document.getElementById('timer'); let seconds = String(timer).padStart(2, '0'); d.textContent=`00:${seconds}`; d.className=''; if(timer>=8)d.classList.add('timer-green'); else if(timer>=5)d.classList.add('timer-yellow'); else d.classList.add('timer-red');}
function playerMove(i){if(board[i]!=='') return; board[i]='X'; clearInterval(timerInterval); renderBoard(); if(checkWinner('X')){ gameOver=true; ticScore.player++; document.getElementById('message').textContent="You win! üéâ"; updateScore(); if(ticScore.player>=3){ setTimeout(startMathChallenge,800);} else { setTimeout(resetBoard,800);} return;} if(board.every(c=>c!=='')){ gameOver=true; ticScore.draw++; updateScore(); setTimeout(resetBoard,800); return;} setTimeout(aiMove,400);}
function aiMove(){if(gameOver)return; const lvl=document.getElementById('levelSelect').value; let move;if(lvl==='easy')move=randomMove(); else if(lvl==='medium')move=mediumMove(); else move=hardMove(); board[move]='O'; renderBoard(); if(checkWinner('O')){gameOver=true; ticScore.ai++; document.getElementById('message').textContent="AI wins! ü§ñ"; updateScore(); if(ticScore.ai>=3){ setTimeout(startMathChallenge,800);} else { setTimeout(resetBoard,800);} return;} if(board.every(c=>c!=='')){gameOver=true; ticScore.draw++; updateScore(); setTimeout(resetBoard,800); return;} startTimer();}
function resetBoard(){board=['','','','','','','','','']; gameOver=false; document.getElementById('message').textContent=''; renderBoard(); startTimer();}
function randomMove(){const e=board.map((v,i)=>v===''?i:null).filter(v=>v!==null); return e[Math.floor(Math.random()*e.length)];}
function mediumMove(){for(let i=0;i<9;i++){if(board[i]===''){board[i]='O'; if(checkWinner('O'))return i; board[i]='';}} for(let i=0;i<9;i++){if(board[i]===''){board[i]='X'; if(checkWinner('X')){board[i]=''; return i;} board[i]='';}} if(board[4]==='') return 4; const c=[0,2,6,8].filter(i=>board[i]===''); if(c.length) return c[Math.floor(Math.random()*c.length)]; return randomMove();}
function hardMove(){let best=-Infinity; let move; for(let i=0;i<9;i++){if(board[i]===''){board[i]='O'; let s=minimax(board,0,false); board[i]=''; if(s>best){best=s; move=i;}}} return move;}
function minimax(b,d,max){if(checkWinner('O')) return 10-d; if(checkWinner('X')) return d-10; if(b.every(c=>c!=='')) return 0; if(max){let best=-Infinity; for(let i=0;i<9;i++){if(b[i]===''){b[i]='O'; best=Math.max(best,minimax(b,d+1,false)); b[i]='';}} return best;} else{let best=Infinity; for(let i=0;i<9;i++){if(b[i]===''){b[i]='X'; best=Math.min(best,minimax(b,d+1,true)); b[i]='';}} return best;}}
function checkWinner(p){const w=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]]; return w.some(x=>x.every(i=>board[i]===p));}
function updateScore(){document.getElementById('scoreboard').textContent=`Player: ${ticScore.player} | AI: ${ticScore.ai} | Draws: ${ticScore.draw}`;}

// ========================== MATH CHALLENGE ==========================
function startMathChallenge(){
  stage='math';
  const container=document.getElementById('gameContainer');
  container.innerHTML=`
    <h1></h1>
    <div id="task">Loading...</div>
    <div id="inputContainer">
      <input id="answer" type="number" placeholder="Your answer" autofocus>
      <button onclick="checkMathAnswer()">OK</button>
    </div>
    <div id="timer">00:30</div>
    <div id="message"></div>
  `;
  mathTimer=30; generateMathTask(); startMathTimer();
}

function randomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min;}
function generateMathTask(){const p=randomInt(1,3); let a,b,c,text; if(p===1){a=randomInt(10,40); b=randomInt(2,12); c=randomInt(5,30); correctAnswer=a+b*c; text=`${a} + ${b} √ó ${c}`;} if(p===2){a=randomInt(20,80); b=randomInt(2,10); c=randomInt(5,30); correctAnswer=a-b*c; text=`${a} ‚àí ${b} √ó ${c}`;} if(p===3){a=randomInt(20,80); b=randomInt(2,10); c=randomInt(2,6); correctAnswer=a+b*c; text=`${a} + ${b} √ó ${c}`;} document.getElementById('task').textContent=`${text} = `; document.getElementById('answer').value=''; document.getElementById('message').textContent=''; document.getElementById('answer').focus();}
function startMathTimer(){clearInterval(mathTimerInterval); mathTimerInterval=setInterval(()=>{mathTimer--; const d=document.getElementById('timer'); const seconds = String(mathTimer).padStart(2, '0'); d.textContent=`00:${seconds}`; d.className=''; if(mathTimer>=20)d.classList.add('timer-green'); else if(mathTimer>=10)d.classList.add('timer-yellow'); else d.classList.add('timer-red'); if(mathTimer<=0){clearInterval(mathTimerInterval); correctMathCount=0; restartGame();}},1000);}
function checkMathAnswer(){const input=document.getElementById('answer'); if(input.value==='')return; clearInterval(mathTimerInterval); if(Number(input.value)===correctAnswer){correctMathCount++; document.getElementById('message').textContent='‚úÖ Correct!'; if(correctMathCount>=9){ setTimeout(startChromaticTrial,700); return;} setTimeout(()=>{mathTimer=30; generateMathTask(); startMathTimer();},700);} else{document.getElementById('message').textContent='‚ùå Wrong!'; correctMathCount=0; setTimeout(restartGame,1000);}}

// ========================== CHROMATIC TRIAL ==========================
const colorsCT=["#ba68c8",
"#64b5f6",
"#81c784",
"#ffb74d",
"#e57373",
"#ffffff",
"#4dd0e1"];
const CHROMATIC_GOAL="#ba68c8"; 
let tilesCT=[], chromaticTime=60, chromaticTimerInterval, uniformTimeout=null, solved=false;

function startChromaticTrial(){
  stage='chromatic';
  const container=document.getElementById('gameContainer');
  container.innerHTML=`
  <h1></h1>

    <div id="grid"></div>
<div id="chromaticWinText" style="
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: 'Press Start 2P', cursive;
  font-size: 1em;
  color: #ffffff;
  text-align: center;
  opacity: 0;
  transition: opacity 1s;
  pointer-events: none;
">
  Correct<br>
  
</div>
    <div id="chromaticText" style="
      margin-top:15px;
      font-family:'Press Start 2P', cursive;
      font-size:0.7em;
      color:#4dd0e1;
      min-height:20px;
      opacity:0;
      transition: opacity 0.5s;
    "></div>

    <div id="timer">60</div>
  `;

  createChromaticGrid();
  startChromaticTimer();

  // üëâ Text nach 10 Sekunden anzeigen
  setTimeout(showChromaticMessage, 10000);
}  

function createChromaticGrid(){
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  tilesCT = [];
  solved = false;

  for(let i=0; i<9; i++){
    const tile = document.createElement('div');
    tile.className = 'tile';

    const idx = Math.floor(Math.random() * colorsCT.length);
    tile.dataset.color = idx;
    tile.style.backgroundColor = colorsCT[idx];

       tile.onclick = () => {
      cycleColor(tile);
      checkWin();
      checkUniformReset();
    };

    tilesCT.push(tile);
    grid.appendChild(tile);
  }
}

// Farbe wechseln beim Klick
function cycleColor(tile){
  if(solved) return;
  let idx = Number(tile.dataset.color);
  idx = (idx + 1) % colorsCT.length;
  tile.dataset.color = idx;
  tile.style.backgroundColor = colorsCT[idx];
}

// Pr√ºfen, ob alle Felder die Ziel-Farbe haben
function checkWin(){
  const allGoal = tilesCT.every(
    t => colorsCT[Number(t.dataset.color)] === CHROMATIC_GOAL
  );

  if(allGoal && !solved){
    solved = true;
    clearInterval(chromaticTimerInterval);
    clearTimeout(uniformTimeout);
    showChromaticWin();
  }
}
// Pr√ºfen, ob alle Felder die gleiche Farbe haben (nicht unbedingt Ziel-Farbe)
function checkUniformReset(){
  const firstColor = colorsCT[Number(tilesCT[0].dataset.color)];
  const allSame = tilesCT.every(t => colorsCT[Number(t.dataset.color)] === firstColor);
  if(allSame && !solved){
    clearTimeout(uniformTimeout);
    uniformTimeout = setTimeout(() => {
      startChromaticTrial(); // Reset auf neue zuf√§llige Farben
    }, 2000); // 2 Sekunden warten
  } else {
    clearTimeout(uniformTimeout);
  }
}

// Timer starten
function startChromaticTimer(){
  clearInterval(chromaticTimerInterval);
  chromaticTime = 60;
  const timerDiv = document.getElementById('timer');

  // erste Anzeige
  let seconds = String(chromaticTime).padStart(2, '0');
  timerDiv.textContent = `00:${seconds}`;

  chromaticTimerInterval = setInterval(()=>{
    chromaticTime--;

    let seconds = String(chromaticTime).padStart(2, '0');
    timerDiv.textContent = `00:${seconds}`;

    timerDiv.className = '';
    if(chromaticTime > 30) timerDiv.classList.add('timer-green');
    else if(chromaticTime > 10) timerDiv.classList.add('timer-yellow');
    else timerDiv.classList.add('timer-red');

    if(chromaticTime <= 0){
      clearInterval(chromaticTimerInterval);
      clearTimeout(uniformTimeout);
      restartGame();
    }
  }, 1000);
}

function showChromaticMessage(){
  var text = document.getElementById('chromaticText');
  if(!text) return;

  text.textContent = " Find the right color";
  text.style.opacity = "1";

  setTimeout(function(){
    text.style.opacity = "0";
  }, 3000);
}
    function restartGame(){
  clearInterval(chromaticTimerInterval);
  clearInterval(mathTimerInterval);
  clearTimeout(uniformTimeout);

  const container = document.getElementById('gameContainer');
  container.innerHTML = `
    <h1></h1>
    <button onclick="startWordChain()">START</button>
  `;

  // Variablen zur√ºcksetzen
  stage = 'start';
  wordScore = 0;
  ticScore = {player:0, ai:0, draw:0};
  currentWord = '';
  usedWords = [];
  board = [];
  gameOver = false;
  correctAnswer = 0;
  correctMathCount = 0;
}
function showChromaticWin(){
  const text = document.getElementById('chromaticWinText');
  if(!text) return;

  text.style.opacity = "1";

  setTimeout(() => {
    restartGame();
  }, 5000); // ‚è± nach 5 Sekunden zur√ºck zum Start
}

</script>
</body>
</html>
